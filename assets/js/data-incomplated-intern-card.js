// Data untuk incomplete intern
// Untuk tags terdapat total 5 tags yang bisa digunakan yaitu : Completed Intern,Extended Intern, Excellent Talent,CEO Verified, Incomplete Intern

document.addEventListener("DOMContentLoaded", () => {
  const dataIncompleteIntern = [
    {
      namaIntern: "Aivi Apriliani Alvionita",
      posisi: "Recruiter Specialist",
      tags: ["Incomplete Intern"],
      AboutIntern:
        "An enthusiastic and driven individual with a passion for digital branding and data analysis. Experienced as a social media analyst, public relation staff, and digital marketer.",
      socialMedia: [{ linkedIn: "https://www.linkedin.com/in/aiviapriliani/" }],
      rating: 2,
      whatsappNumber: "+6285157589963",
      profilePage: "aivi-apriliani-alvionita.html",
      avatarPath:
        "../assets/img/portofolio/aivi-apriliani-alvionita/aivi-apriliani.jpeg",
      resumePath: null,
    },
    {
      namaIntern: "Muh Surya Putra Fajar",
      posisi: "Content Creator",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        { instagram: "https://www.instagram.com/suryapf_" },
        {
          linkedIn:
            "https://www.linkedin.com/in/muh-surya-putra-fajar-244ab9316/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6282344212065",
      profilePage: "muh-surya-putra.html",
      avatarPath: "../assets/img/portofolio/muh-surya-putra-fajar/avatar.jpg",
      resumePath: null,
    },
    {
      namaIntern: "Anis Hasnawati",
      posisi: "Recruiter Specialist",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        { instagram: "http://instagram.com/anishasna_" },
        { linkedIn: "https://www.linkedin.com/in/anis-hasnawati" },
      ],
      rating: 2,
      whatsappNumber: "+6282143700131",
      profilePage: null,
      avatarPath: "",
      resumePath: null,
    },
    {
      namaIntern: "Adelia Wahyu Suryandari",
      posisi: "Client Manager",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        { instagram: "https://instagram.com/adeliawys" },
        { linkedIn: "https://www.linkedin.com/in/adelia-wahyu-suryandari/" },
      ],
      rating: 2,
      whatsappNumber: "+6281325012868",
      profilePage: null,
      avatarPath: "",
      resumePath: null,
    },
    {
      namaIntern: "Mayla Anita Fariska",
      posisi: "Client Manager",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        { instagram: "http://instagram.com/maynfr" },
        { linkedIn: "https://www.linkedin.com/in/maylaanitafariska" },
      ],
      rating: 2,
      whatsappNumber: "+6285954365493",
      profilePage: null,
      avatarPath: "",
      resumePath: null,
    },
    {
      namaIntern: "Al Virizky Arjunitha Al Munawir",
      posisi: "Client Manager",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [{ instagram: "instagram.com/alvrzkyam" }],
      rating: 2,
      whatsappNumber: "+6285702708164",
      profilePage: null,
      avatarPath: "",
      resumePath: null,
    },
    {
      namaIntern: "Elzahra Aufi Salsabila",
      posisi: "HTML Writer",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        { linkedIn: "https://www.linkedin.com/in/elzahra-aufi-49a563222/" },
      ],
      rating: 2,
      whatsappNumber: "+628976227887",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/elzahra-aufi-salsabila/avatar.jpg",
      resumePath: null,
    },
    {
      namaIntern: "Ariani Eka Putri",
      posisi: "Admin Kelas",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [{ linkedIn: "https://www.linkedin.com/in/aariiyy/" }],
      rating: 2,
      whatsappNumber: "+62895344393231",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/ariani-eka-putrii/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Audi Faradilla Rachman",
      posisi: "HR Generalist",
      tags: ["Incomplete Intern"],
      AboutIntern:
        "Mahasiswa D4 Administrasi Negara Universitas Negeri Surabaya yang memiliki minat di bidang administrasi dan kepegawaian. Selama berkuliah aktif dalam organisasi dan berkontribusi dalam penelitian dengan dosen sehingga ikut serta mempublikasikan artikel.",
      socialMedia: [
        {
          linkedIn:
            "https://www.linkedin.com/in/audi-faradilla-rachman-6b4775217/",
        },
      ],
      rating: 2,
      whatsappNumber: "+62895344393231",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/audi-faradilla-rachman/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Hanifah Mutiara Puspa",
      posisi: "AI Content/Copy Writer",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/hanifahmutiara/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6285191259268",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/hanifah-mutiara-puspa/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Imroatun Nurul Jannah",
      posisi: "Recruiter Specialist",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/imroatun-nurul-a9946b306/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6282131851856",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/imroatun-nurul-jannah/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Melta Meliano Putri",
      posisi: "Content Creator",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/melta-meliano-putri/",
        },
      ],
      rating: 2,
      whatsappNumber: "+628953800439",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/melta-meliano-putri/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Dinda Artya Hamidah",
      posisi: "Social Media Analyst",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/dindaartya/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6287838190516",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/dinda-artya-hamidah/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Firly Faturachmi Yatnikaputri",
      posisi: "Telemarketing",
      tags: ["Incomplete Intern"],
      AboutIntern: "Iâ€™m bachelor management graduate from Universitas Islam Indonesia. I have hands-on experience in sales promotion and sales pricing at Telkom Indonesia. Skilled in SAP ERP, teamwork, marketing, and data analysis. These areas of interest and expertise are supported by certifications in Data Analytics and SAP Overview.",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/firly-faturachmi-8646401b7/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6285797853194",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/firly-faturachmi/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Paulina Berliana Ananto",
      posisi: "Admin Kelas",
      tags: ["Incomplete Intern"],
      AboutIntern: "............",
      socialMedia: [
        {
          linkedIn: "http://linkedin.com/in/PaulinaBerlianaAnanto/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6285797853194",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/paulina-berliana/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Estetika Nusantara Yutardo",
      posisi: "HTML Writer",
      tags: ["Incomplete Intern"],
      AboutIntern: "Estetika is a highly motivated and hardworking undergraduate Information System student, with a passion for data science and creative design, especially in website design and development. She is currently an event organizer staff member at the Google Developer Student Club where she pursues her creative thinking skills and public speaking.",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/estetika-nusantara-yutardo-667223247/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6282329310878",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/paulina-berliana/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Evina Delavani",
      posisi: "People Development",
      tags: ["Incomplete Intern"],
      AboutIntern: "A Certified Human Capital Officer (CHCO) with a Bachelor's degree in Human Resources Management from Universitas Islam Indonesia and a passion for fostering organizational growth through strategic talent acquisition and employee development. Recently contributed to diverse recruitment and people development initiatives, sourcing top talent and designing impactful training programs.",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/evinadelavani/",
        },
      ],
      rating: 2,
      whatsappNumber: "+6285162625457",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/evina-delavani/avatar.webp",
      resumePath: null,
    },
    {
      namaIntern: "Ghiyatsa Syifa Kirana",
      posisi: "Admin Kelas",
      tags: ["Incomplete Intern"],
      AboutIntern: "Undergraduate communication science student specializing in public relations, skilled in external links, strategic communications, and media relations. Proven track record in building cooperative relationships. Proficient in public affairs, conflict resolution, and decisionmaking processes. Adept at empowering communities through targeted programs.",
      socialMedia: [
        {
          linkedIn: "https://www.linkedin.com/in/ghiyatsasyifa/"
        },
      ],
      rating: 2,
      whatsappNumber: "+6282153917890",
      profilePage: null,
      avatarPath: "../assets/img/portofolio/ghiyatsa-syifa/avatar.webp",
      resumePath: null,
    },
  ];

  // Helper to determine badge colors
  const getTagClass = (tag) => {
    switch (tag) {
      case "Completed Intern":
        return "text-bg-success";
      case "Extended Intern":
        return "text-bg-info";
      case "Excellent Talent":
        return "text-bg-warning";
      case "CEO Verified":
        return "text-bg-primary";
      case "Incomplete Intern":
        return "text-bg-danger";
      default:
        return "text-bg-secondary";
    }
  };

  // Helper to generate star ratings
  const generateStars = (rating) => {
    return Array.from({ length: 5 }, (_, i) => {
      if (i < Math.floor(rating)) return '<i class="bi bi-star-fill"></i>';
      if (i < rating) return '<i class="bi bi-star-half"></i>';
      return '<i class="bi bi-star"></i>';
    }).join("");
  };

  // SVG Icons untuk platform social media
  const getSocialIcon = (platform, url) => {
    const icons = {
      facebook: `<svg viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M15.997 3.985h2.191V.169C17.81.117 16.51 0 14.996 0c-3.159 0-5.323 1.987-5.323 5.639V9H6.187v4.266h3.486V24h4.274V13.267h3.345l.531-4.266h-3.877V6.062c.001-1.233.333-2.077 2.051-2.077z" />
                </svg>`,
      youtube: `<svg viewBox="0 0 32 32"
                  xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M12.932 20.459v-8.917l7.839 4.459zM30.368 8.735c-0.354-1.301-1.354-2.307-2.625-2.663l-0.027-0.006c-3.193-0.406-6.886-0.638-10.634-0.638-0.381 0-0.761 0.002-1.14 0.007l0.058-0.001c-0.322-0.004-0.701-0.007-1.082-0.007-3.748 0-7.443 0.232-11.070 0.681l0.434-0.044c-1.297 0.363-2.297 1.368-2.644 2.643l-0.006 0.026c-0.4 2.109-0.628 4.536-0.628 7.016 0 0.088 0 0.176 0.001 0.263l-0-0.014c-0 0.074-0.001 0.162-0.001 0.25 0 2.48 0.229 4.906 0.666 7.259l-0.038-0.244c0.354 1.301 1.354 2.307 2.625 2.663l0.027 0.006c3.193 0.406 6.886 0.638 10.634 0.638 0.38 0 0.76-0.002 1.14-0.007l-0.058 0.001c0.322 0.004 0.702 0.007 1.082 0.007 3.749 0 7.443-0.232 11.070-0.681l-0.434 0.044c1.298-0.362 2.298-1.368 2.646-2.643l0.006-0.026c0.399-2.109 0.627-4.536 0.627-7.015 0-0.088-0-0.176-0.001-0.263l0 0.013c0-0.074 0.001-0.162 0.001-0.25 0-2.48-0.229-4.906-0.666-7.259l0.038 0.244z" />
                </svg>`,
      instagram: `<svg
                  viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                  <path d="M301 256c0 24.852-20.148 45-45 45s-45-20.148-45-45 20.148-45 45-45 45 20.148 45 45zm0 0" />
                  <path
                    d="M332 120H180c-33.086 0-60 26.914-60 60v152c0 33.086 26.914 60 60 60h152c33.086 0 60-26.914 60-60V180c0-33.086-26.914-60-60-60zm-76 211c-41.355 0-75-33.645-75-75s33.645-75 75-75 75 33.645 75 75-33.645 75-75 75zm86-146c-8.285 0-15-6.715-15-15s6.715-15 15-15 15 6.715 15 15-6.715 15-15 15zm0 0" />
                  <path
                    d="M377 0H135C60.562 0 0 60.563 0 135v242c0 74.438 60.563 135 135 135h242c74.438 0 135-60.563 135-135V135C512 60.562 451.437 0 377 0zm45 332c0 49.625-40.375 90-90 90H180c-49.625 0-90-40.375-90-90V180c0-49.625 40.375-90 90-90h152c49.625 0 90 40.375 90 90zm0 0" />
                </svg>`,
      linkedIn: `<svg viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M23.994 24v-.001H24v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07V7.976H8.489v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243V24zM.396 7.977h4.976V24H.396zM2.882 0C1.291 0 0 1.291 0 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909A2.884 2.884 0 002.882 0z" />
                </svg>`,
      tiktok: `<svg
          viewBox="0 0 256 256"
          xmlns="http://www.w3.org/2000/svg">
          <path d="M232,84v40a7.99977,7.99977,0,0,1-8,8,103.32406,103.32406,0,0,1-48.00049-11.70752L176,156A76,76,0,1,1,86.59766,81.17971,7.99952,7.99952,0,0,1,96,89.05569l-.00049,41.63916a7.99971,7.99971,0,0,1-4.56689,7.22607A20.00272,20.00272,0,1,0,120,156V28a7.99977,7.99977,0,0,1,8-8h40a7.99977,7.99977,0,0,1,8,8,48.05436,48.05436,0,0,0,48,48A7.99977,7.99977,0,0,1,232,84Z"></path>
        </svg>`,
      twitter: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M 2.8671875 3 L 9.7363281 12.818359 L 2.734375 21 L 5.3808594 21 L 10.919922 14.509766 L 15.460938 21 L 21.371094 21 L 14.173828 10.697266 L 20.744141 3 L 18.138672 3 L 12.996094 9.0097656 L 8.7988281 3 L 2.8">
                  </path>
                </svg>`,
    };

    return `<a href="${url}" target="_blank">${icons[platform]}</a>`;
  };

  const container = document.querySelector('[data-id="incomplete-intern"]');

  const filterInput = document.getElementById("filter-posisi");
  const searchInput = document.getElementById("search-input-intern");

  const renderIncompleteInternCard = () => {
    const posisi = filterInput.value.toLowerCase();
    const nama = searchInput.value.toLowerCase();

    const filteredDataIncompleteIntern = dataIncompleteIntern.filter((item) => {
      const filteredPosisi =
        posisi === "all" || item.posisi.toLowerCase() === posisi;
      const filteredNama =
        nama === "" || item.namaIntern.toLowerCase().includes(nama);

      return filteredNama && filteredPosisi;
    });

    // MAP data incomplete intern untuk membuat card untuk masing-masing intern
    if (container) {
      const incompleteCardsHTML = filteredDataIncompleteIntern
        .map((internData) => {
          // Membuat TAGS "Incomplete Intern"
          const tagsHTML = internData.tags
            .map(
              (tag) =>
                `<span class="badge rounded-pill ${getTagClass(
                  tag
                )}">${tag}</span>`
            )
            .join(" ");

          const socialLinksHTML = internData.socialMedia
            .map((social) => {
              const platform = Object.keys(social)[0];
              const url = social[platform];
              return getSocialIcon(platform, url);
            })
            .join(" ");

          const starsHTML = generateStars(internData.rating);

          // Check if text is longer than 150 characters and create read more functionality
          const aboutText = internData.AboutIntern;
          const isLongText = aboutText.length > 150;
          const shortText = isLongText ? aboutText.slice(0, 150).replace(/\s+\S*$/, "").trim() : aboutText;
          const longText = isLongText ? aboutText.slice(shortText.length).trim() : "";
          
          const aboutMeHTML = isLongText 
            ? `<p class="card-desc">
                ${shortText}
                <span class="dots">...</span>
                <span class="moreText" style="display: none;">
                  ${longText}
                </span>
                <span class="readMore"> Read More &raquo;</span>
                <span class="readLess" style="display: none;"> &laquo; Read Less</span>
              </p>`
            : `<p class="card-desc">${aboutText}</p>`;

          return `
          <div class="card mt-4 mb-4" data-state="#about">
            <div class="card-header">
              <div class="card-cover" style="
        background-image: url('https://images.unsplash.com/photo-1549068106-b024baf5062d?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=934&q=80');"></div>
              <img class="card-avatar" src="${
                internData.avatarPath || ""
              }" alt="avatar ${internData.namaIntern}" />
              <h1 class="card-fullname">
                ${internData.namaIntern}
              </h1>
              <h2 class="card-jobtitle">${internData.posisi}</h2>
              <div class="top-left">${starsHTML}</div>
              ${
                internData.resumePath &&
                `<div class="top-right">
                    <a
                      href="${internData.resumePath}"
                      target="_blank">
                      <i class="bi bi-box-arrow-in-down"></i>
                    </a>
                  </div>`
              }
            </div>
  
            <div class="card-main">
              <div class="card-section is-active" id="about">
                <div class="card-content">
                  <div class="card-subtitle">About Me</div>
                  ${aboutMeHTML}
                  <p class="card-desc small">${tagsHTML}</p>
                </div>
                <div class="card-social">${socialLinksHTML}</div>
              </div>
            </div>
            <div class="card-buttons">
              <button data-section="#about" class="about-me-animate" 
                ${
                  internData.profilePage
                    ? `onclick="window.location.href='${internData.profilePage}'"`
                    : "disabled"
                }
                ${!internData.profilePage ? "disabled" : ""}>
                <i class="bi bi-person-circle"></i> About Me
              </button>
              <button onclick="location.href='https://wa.me/${internData.whatsappNumber.replace(
                /\D/g,
                ""
              )}';">
                <i class="bi bi-whatsapp"></i> Whatsapp Me
              </button>
              <button onclick="location.href='mailto:admin@dialogika.co';">
                <i class="bi bi-envelope-at"></i> My Supervisor
              </button>
            </div>
          </div>
        `;
        })
        .join("");

      // Insert the incomplete intern cards after the section title
      const sectionTitle = container.querySelector(".incomplete-intern-title");
      if (sectionTitle) {
        sectionTitle.insertAdjacentHTML("afterend", incompleteCardsHTML);
      }
    }
  };

  renderIncompleteInternCard();

  // Add read more/read less functionality
  const addReadMoreListeners = () => {
    const readMoreElements = document.querySelectorAll('.readMore');
    const readLessElements = document.querySelectorAll('.readLess');
    const moreTextElements = document.querySelectorAll('.moreText');
    const dotsElements = document.querySelectorAll('.dots');

    readMoreElements.forEach((element, index) => {
      element.addEventListener('click', function() {
        moreTextElements[index].style.display = 'inline';
        readLessElements[index].style.display = 'inline';
        readMoreElements[index].style.display = 'none';
        dotsElements[index].style.display = 'none';
      });
    });

    readLessElements.forEach((element, index) => {
      element.addEventListener('click', function() {
        moreTextElements[index].style.display = 'none';
        readLessElements[index].style.display = 'none';
        readMoreElements[index].style.display = 'inline';
        dotsElements[index].style.display = 'inline';
      });
    });
  };

  // Add listeners after initial render
  addReadMoreListeners();

  // Event listener untuk select dan input search
  if (filterInput) {
    filterInput.addEventListener("change", () => {
      // Clear existing incomplete intern cards
      const existingCards = container.querySelectorAll(".card");
      existingCards.forEach((card) => card.remove());
      renderIncompleteInternCard();
      // Re-add listeners after re-rendering
      addReadMoreListeners();
    });
  }

  if (searchInput) {
    searchInput.addEventListener("input", () => {
      // Clear existing incomplete intern cards
      const existingCards = container.querySelectorAll(".card");
      existingCards.forEach((card) => card.remove());
      renderIncompleteInternCard();
      // Re-add listeners after re-rendering
      addReadMoreListeners();
    });
  }
});
